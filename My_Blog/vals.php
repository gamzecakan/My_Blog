<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> bu da olur icon için -->
    <script src="https://kit.fontawesome.com/c20485228a.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="owl/owl.carousel.min.css">
    <link rel="stylesheet" href="owl/owl.theme.default.min.css">
    <!--owl carousel indirdik blog kartları arasında kaydırma olsun diye bunu slider da yapabilrdim şimdilik boyle olsun-->
    <link rel="icon" href="images/blog.png">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="blogs.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
        integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <title>Vals | Blog</title>

    <style>
        .rating {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            background-color:#f6f6f6;
        }

        .descripton {
            width: calc(50% - 30px);
            /* 50% width with 40px margin */
            margin: 20px;
        }

        h3 {
            text-align: center;
        }


    </style>
</head>

<body>

    <section id="menu">
        <div id="logo">Gamze <i class="fas fa-heart icon"></i></div>

        <nav>
            <a href="index.php" style="text-decoration:none; color:#9f86c0"><i class="fas fa-home icon"></i>Anasayfa</a>
            <!--icon diye class ta belirtiyorum ki biçimlendirme kolay olsun-->
            <a href="index.php#about" style="text-decoration:none; color:#9f86c0"><i
                    class="fas fa-info icon"></i>Hakkımda</a>
            <a href="index.php#blog" style="text-decoration:none; color:#9f86c0"><i
                    class="fas fa-dice icon"></i>Portfolyo</a>
            <a href="blogs.php" style="text-decoration:none; color:#9f86c0"><i class="fas fa-user icon"></i>Blog</a>
            <a href="index.php#contact" style="text-decoration:none; color:#9f86c0"><i
                    class="fas fa-link icon"></i>İletişim</a>
        </nav>
    </section>


    <div class="rating">
        <div class="dance">
            <h2>VALS</h2>
            <img src="images/dance/vals.jpg" alt=""><br><br><br>
            <p>Vals,<strong>3/4 zamanlı bir Avusturya</strong> dansıdır. En belirgin özelliği, çiftlerin birbirine
                sıkıca tutunup bir nokta çevresinde dönerek dans etmeleridir.</p>
        </div>

        <div class="descripton">
            <p style=" letter-spacing:1px; color:#231942;"><strong>Tarih:</strong> Vals, 18. yüzyıl Avrupa'sında ortaya
                çıktı ve kökenleri Almanya ve Avusturya'ya dayanmaktadır. İlk olarak halk dansı olarak başladı ve
                zamanla aristokratlar arasında popüler hale geldi. 19. yüzyılın başlarında, vals Viyana Balosu'nda büyük
                bir popülerlik kazandı ve daha sonra Avrupa'nın geri kalanına ve Amerika'ya yayıldı.
                <br><br><strong>Müzik: </strong>Vals, genellikle üç zamanlı bir müzik ritmine sahiptir. 3/4 zaman
                imzasıyla karakterizedir, yani her ölçüde üç vuruş bulunur. Bu ritmik yapı, dansın akışını ve zarafetini
                belirler. Klasik müzik, operetler ve popüler müzik gibi çeşitli müzik türleri vals için kullanılır.
                <br><br><strong>Dans Tekniği:</strong> Vals, çiftlerin birbirine sıkıca sarılarak bir nokta çevresinde
                dönerek dans ettiği bir dairesel dans olarak bilinir. Bu dönüşler, genellikle zarif ve kademeli olarak
                yapılır ve dansçıların birlikte uyum içinde hareket etmesini gerektirir. Valsın temposu genellikle orta
                hızdadır, ancak farklı varyasyonlarında tempo değişebilir.
                <br><br><strong>Stil ve İfade: </strong>Vals, romantik bir dans olarak kabul edilir. Dansçılar,
                kollarını ve bedenlerini zarif bir şekilde hareket ettirirler ve birbirlerine olan bağlılıklarını ve
                duygularını ifade ederler. Valsın akıcı ve yumuşak hareketleri, dansçıların duygusal bir bağ kurmasını
                sağlar ve izleyicilere duygusal bir deneyim sunar.
                <br><br><strong>Popülerlik ve Yaygınlık: </strong>Vals, dünya çapında popüler bir dans türüdür. Hem
                profesyonel dansçılar hem de amatör dansçılar arasında yaygın olarak icra edilir. Düğünlerde, balolarda,
                dans yarışmalarında ve sosyal etkinliklerde sıkça görülür. Ayrıca vals, birçok dans okulunun temel
                dansları arasında yer alır ve dansseverler için popüler bir seçenektir.
        </div>

    </div>
<br><br>
    <div class="container">
        <div class="card">
            <div class="card-header">OYUNUZLA DEĞERLENDİRİN</div>
            <div class="card-body">
                <div class="row">
                    <div class="col-sm-4 text-center">
                        <h1 class="text-warning mt-4 mb-4">
                            <b><span id="average_rating">0.0</span> / 5</b> <!--ortalamayı görücez veritabaındaki veriler sayesinde-->
                        </h1>
                        <div class="mb-3">
                            <i class="fas fa-star star-light mr-1 main_star"></i><!--5yıldız görüntülenecek-->
                            <i class="fas fa-star star-light mr-1 main_star"></i>
                            <i class="fas fa-star star-light mr-1 main_star"></i>
                            <i class="fas fa-star star-light mr-1 main_star"></i>
                            <i class="fas fa-star star-light mr-1 main_star"></i>
                        </div>
                        <h3><span id="total_review">0</span><br>Kullanılan Oy Adedi</h3><!--toplam inceleme sayısını görücez veritabanındaki verileri çekebilrisek-->
                    </div>
                    <div class="col-sm-4">
                        <p>
                        <div class="progress-label-left"><b>5</b> <i class="fas fa-star text-warning"></i></div>

                        <div class="progress-label-right">(<span id="total_five_star_review">0</span>)</div>
                        <div class="progress">
                            <div class="progress-bar bg-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                                aria-valuemax="100" id="five_star_progress"></div> <!--alan değerini max 100 verdik-->
                        </div>
                        </p>
                        <p>
                        <div class="progress-label-left"><b>4</b> <i class="fas fa-star text-warning"></i></div>

                        <div class="progress-label-right">(<span id="total_four_star_review">0</span>)</div>
                        <div class="progress">
                            <div class="progress-bar bg-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                                aria-valuemax="100" id="four_star_progress"></div>
                        </div>
                        </p>
                        <p>
                        <div class="progress-label-left"><b>3</b> <i class="fas fa-star text-warning"></i></div>

                        <div class="progress-label-right">(<span id="total_three_star_review">0</span>)</div>
                        <div class="progress">
                            <div class="progress-bar bg-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                                aria-valuemax="100" id="three_star_progress"></div>
                        </div>
                        </p>
                        <p>
                        <div class="progress-label-left"><b>2</b> <i class="fas fa-star text-warning"></i></div>

                        <div class="progress-label-right">(<span id="total_two_star_review">0</span>)</div>
                        <div class="progress">
                            <div class="progress-bar bg-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                                aria-valuemax="100" id="two_star_progress"></div>
                        </div>
                        </p>
                        <p>
                        <div class="progress-label-left"><b>1</b> <i class="fas fa-star text-warning"></i></div>

                        <div class="progress-label-right">(<span id="total_one_star_review">0</span>)</div>
                        <div class="progress">
                            <div class="progress-bar bg-warning" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                                aria-valuemax="100" id="one_star_progress"></div>
                        </div>  <!--1-5 arası tüm yıldızları ilerledik copy/paste te id'leri değişmeyi unutmadık. one-two-three vb.-->
                        </p>
                    </div>
                    <div class="col-sm-4 text-center">
                        <h3 class="mt-4 mb-3">Oyunuzu kullanın</h3>
                        <button type="button" name="add_review" id="add_review" class="btn btn-primary">Kullan</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-5" id="review_content"></div>
    </div>
</body>

</html>
    <div id="review_modal" class="modal" tabindex="-1" role="dialog"> <!--bootstrapten faydalandık-->
    <!-- Kullanıcıların derecelendirme ve yorumlarını göndermek için kullanılan modal penceresini tanımlar.-->
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Submit Review</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h4 class="text-center mt-2 mb-4">
                        <i class="fas fa-star star-light submit_star mr-1" id="submit_star_1" data-rating="1"></i> <!--derecelendirme yıldızları işte 5 tane-->
                        <i class="fas fa-star star-light submit_star mr-1" id="submit_star_2" data-rating="2"></i>
                        <i class="fas fa-star star-light submit_star mr-1" id="submit_star_3" data-rating="3"></i>
                        <i class="fas fa-star star-light submit_star mr-1" id="submit_star_4" data-rating="4"></i>
                        <i class="fas fa-star star-light submit_star mr-1" id="submit_star_5" data-rating="5"></i>
                    </h4>
                    <div class="form-group">
                        <input type="text" name="user_name" id="user_name" class="form-control"
                            placeholder="Enter Your Name" />
                    </div>
                    <div class="form-group">
                        <textarea name="user_review" id="user_review" class="form-control"
                            placeholder="Type Review Here"></textarea>
                    </div>
                    <div class="form-group text-center mt-4">
                        <button type="button" class="btn btn-primary" id="save_review">Gönder</button>
                    </div>
                </div>
            </div>
        </div>
    </div>



<script>
    var rating_data = 0; //dercelendrime değerini tutucam burada

        $('#add_review').click(function(){ //modal pencersini açıyoruz

            $('#review_modal').modal('show');

        });

        $(document).on('mouseenter', '.submit_star', function(){
            //kullanıcı fareyi yıldızın üstüne getirdiğinde bu-> mouseenter
            //submit_star sınıfından yıldız sayısı kadar

            var rating = $(this).data('rating');

            reset_background(); //sarı renk olur

            for(var count = 1; count <= rating; count++)
            {

                $('#submit_star_'+count).addClass('text-warning');

            }

        });

        function reset_background() //yıldızlar baştaki rengine dönsün
        {
            for(var count = 1; count <= 5; count++)
            {

                $('#submit_star_'+count).addClass('star-light');

                $('#submit_star_'+count).removeClass('text-warning');

            }
        }

        $(document).on('mouseleave', '.submit_star', function(){

            reset_background();//mouseleave ile fare yıldızdan çekilince yıldızlar sfırlansın seçililer sarı olsun

            for(var count = 1; count <= rating_data; count++)
            {

                $('#submit_star_'+count).removeClass('star-light');

                $('#submit_star_'+count).addClass('text-warning');
            }

        });

        $(document).on('click', '.submit_star', function(){

            rating_data = $(this).data('rating'); //kullanıcı yıldıza tıkladığında rating_data dercelendirmesi ayarlansın

        });

        $('#save_review').click(function(){ //yapılan&seçilen oylamayı kaydediyoruz

            var user_name = $('#user_name').val();

            var user_review = $('#user_review').val();

            if(user_name == '' || user_review == '')
            {
                alert("Lütfen bilgilerinizi eksiksiz girin.");
                return false; //kullanıcı adı ve oyundan herhangi biri boşsa uyarı mesajı
            }
            else
            {
                $.ajax({ //her ikisi de doluysa AJAX ile submit_rating.php ye veri gönderilir
                    url:"submit_rating.php",
                    method:"POST",
                    data:{rating_data:rating_data, user_name:user_name, user_review:user_review},
                    success:function(data)
                    {
                        $('#review_modal').modal('hide');

                        load_rating_data();

                        alert(data);
                    }
                })//başarılı olursa modal kapanır
            }

        });
       
        load_rating_data(); //verilen oyların yüklenmesi gerekiyor

        function load_rating_data()
        {
        $.ajax({
            url:"submit_rating.php",
            method:"POST",
            data:{action:'load_data'},
            dataType:"JSON",
            success:function(data) //fonk. dönüş tipi json olmak üzere submit_rating.php dosyasına ajax post isteği gönderilir
            //veri olarak load_data verisi gönderilir ve başarı durumu success
            {
                $('#average_rating').text(data.average_rating);
                $('#total_review').text(data.total_review);
                //ajax isteği sonrası ort değer ve total # ifadelerien yazdırılır

                var count_star = 0;//yıldız saymak için

                $('.main_star').each(function(){
                    //main_star sınıfına sahip her bir öge döngüye girecek
                    count_star++;
                    if(Math.ceil(data.average_rating) >= count_star)//ceil int e yuvarlıyor 
                    {
                        $(this).addClass('text-warning');
                        $(this).addClass('star-light');//yıldız yansın ve renklensin vs
                    }
                });
    
            $('#total_five_star_review').text(data.five_star_review);

            $('#total_four_star_review').text(data.four_star_review);

            $('#total_three_star_review').text(data.three_star_review);

            $('#total_two_star_review').text(data.two_star_review);

            $('#total_one_star_review').text(data.one_star_review);//1-5 yıldız değerlendirmesini + totalini HTML elemanlarına yazdırır

            $('#five_star_progress').css('width', (data.five_star_review/data.total_review) * 100 + '%');

            $('#four_star_progress').css('width', (data.four_star_review/data.total_review) * 100 + '%');

            $('#three_star_progress').css('width', (data.three_star_review/data.total_review) * 100 + '%');

            $('#two_star_progress').css('width', (data.two_star_review/data.total_review) * 100 + '%');

            $('#one_star_progress').css('width', (data.one_star_review/data.total_review) * 100 + '%');//her bir yıldız değerlendirmesinin ilerlemesini çubuk üzerinden oranlasın
            
            
            if(data.review_data.length > 0)//verileri& oylamaları görüntülesin
                {
                    var html = '';//veriler burada tutulacak boş string şuan

                    for(var count = 0; count < data.review_data.length; count++)
                    {
                        html += '<div class="row mb-3">';
                        //row mb-3 sınıfı kartın bir satırı->row ve alt kenar boşluğu->mb3 ile ekler

                        html += '<div class="col-sm-1"><div class="rounded-circle bg-danger text-white pt-2 pb-2"><h3 class="text-center">'+data.review_data[count].user_name.charAt(0)+'</h3></div></div>';
                        //kullanıcıın adının ilk harfini oluşturan daire

                        html += '<div class="col-sm-11">';
                        //inceleme kartının ana içeriğini (kullanıcı adı,değerlendirmesi,tarih)içerir

                        html += '<div class="card">';

                        html += '<div class="card-header"><b>'+data.review_data[count].user_name+'</b></div>';

                        html += '<div class="card-body">';

                        for(var star = 1; star <= 5; star++)
                        {
                            var class_name = '';

                            if(data.review_data[count].rating >= star)//değerlendirme bu şartı sağlarsa yıldız sarı olsın
                            {
                                class_name = 'text-warning';
                            }
                            else
                            {
                                class_name = 'star-light';
                            }

                            html += '<i class="fas fa-star '+class_name+' mr-1"></i>';//mr-1 sağdan bir boşluğu ifade eder.
                        }

                        html += '<br />';

                        html += data.review_data[count].user_review;//metin&tarih html i 

                        html += '</div>';

                        html += '<div class="card-footer text-right">On '+data.review_data[count].datetime+'</div>';
                        //tarih sağ alta hizalansın

                        html += '</div>';

                        html += '</div>';

                        html += '</div>';
                    }

                    $('#review_content').html(html);//html içeriği, incelemeler vs. sayfada görüntülensin
                }
            }
        })
    }
</script>

<br><br><br>
<hr>
<footer>
    <div class="social_footer">
        <ul>
            <li><i class="fab fa-instagram account"></i></li>
            <li><i class="fab fa-linkedin account"></i></li>
            <li><i class="fab fa-github account"></i></li>
            <li><i class="fab fa-google-plus-g account"></i></li>
            <li><i class="fab fa-whatsapp account"></i></li>
        </ul>
    </div>
<hr>

</footer>